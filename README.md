
# CREO3_STARTUP_DJDMP_BATCH

_한 방에 사내 표준 PTC CREO 환경을 설정해 주는 도구_

* 2017-03-06
* by DymaxionKim
* HealthCare Division of DaejinDMP Co., LTD.
* Download : <https://github.com/dymaxionkim/CREO3_STARTUP_DJDMP/archive/master.zip>

## 목적
* 기계적으로 순서대로 따라하기만 하면 자동으로 작업환경 구성이 간단히 되도록 한다.
* GrabCAD 서비스로 클라우드 PDM 환경을 구성한다.
* 환경설정 및 모든 데이타는 전부 하나의 패키지로 쉽게 백업이 될 수 있도록 한다.


## 셋업 순서

### 선행작업 (전제조건)
* PTC CREO 3.0 M010 Parametric 일 것.
* CREO 설치 장소는 반드시 "C:\PTC" 폴더를 만들고 그 안에 설치되어야 함.
* 데이타 저장 장소는 반드시 "E:\GrabCAD" 폴더일 것.
* 만일 데이타 저장용 드라이브 문자가 "E:"가 아닐 경우에는, `시작 - 프로그램 - Windows관리도구 - 컴퓨터관리`에서, `저장소 - 디스크관리`에 들어간 후, 데이타 저장용 드라이브에서 마우스 오른쪽 버튼을 누르고 `드라이브 문자 및 경로 변경`을 통해서 "E:" 드라이브로 문자를 강제로 셋팅해 주어야 함.
* 만일 데이타 저장용 드라이브가, 로컬PC의 것이 아니고 네트워크드라이브로 연결되는 경우에는 "E:"드라이브로 할당해 줄 것.
* 이상의 전제조건은 반드시 준수해야 한다. (다르게 할 경우에는 골치아파짐)

### GrabCAD 가입
* GrabCAD Workbench는 범용적인 PDM 기능이 훌륭하게 제공될 뿐만 아니라, 완전 무료에 용량제한이 없다.
* 사용법도 쉽기 때문에 도입 단계 PDM으로 운용하기에 적합하다고 생각된다.
* GrabCAD Workbench 홈페이지로 우선 간다. : https://workbench.grabcad.com
* 우측 상단의 '로그인' 버튼을 누르고 '구성원이 아닙니까?' 문구를 눌러 회사 이메일로 회원가입할것.  (Facebook/Linkedin/Google 중 아무거나 계정이 있을 경우 해당 서비스 버튼을 누르면 자동으로 소셜로그인이 되지만, 업무용 계정으로 사용할 것이므로 새로 아이디를 만들어주자.)
* 로그인이 되었으면, 우측 상단의 자기 아이디를 누르고 '프로파일 설정'에 들어가서 개인정보를 추가 입력해 준다. (아바타 그림, 이름, 국가, 기본 홈페이지, 언어, 암호, 이메일 알림 등)

### 팀장에게 초대받기
* 만들어진 아이디(이메일주소)을 팀장에게 통보한다.
* 그러면 팀장은 GrabCAD 상에서 자신을 새로운 사용자로 초대할 것이다.
* 팀장으로부터 초대가 되면, 우측 상단에 종 모양 아이콘에서 협력작업자로 선택된 프로젝트들의 숫자가 뜨는 것을 확인할 수 있다.

### Workbench 클라이언트 프로그램 설치
* 이 클라이언트 프로그램의 역할은, GrabCAD 클라우드 저장소의 데이타와 항상 데이타를 동기화 해 주고, 협력작업을 위한 것이다.
* Workbench 웹사이트 상단의 'Download app' 버튼을 누르고, 클라이언트 프로그램 설치 버튼을 누른다.
* 다운로드가 다 되면, 그것을 자신의 컴퓨터에 설치한다.
* 최초 실행 후, 자신의 아이디로 로그인 한다.  톱니바퀴 모양 아이콘을 누르고 'Settings..'로 들어간다.
* 여기서 'Change Default Folder and Accor'를 누르고 'E:\GrabCAD' 폴더로 셋팅해 준다.
* 로컬 하드디스크가 아니고, 네트워크 드라이브로 연결해야 할 경우에는 네트워크 쪽으로 찾아들어가면 된다.

### 팀장이 공유한 프로젝트 확인
* 이제 팀장이 공유해 준 프로젝트를 받아오기로 한다.
* 톱니바퀴 모양 아이콘을 누르고 'Manually Connect Project..'로 들어간다.
* 그러면 팀장이 공유해 준 프로젝트들이 나타난다.
* 각 프로젝트들의 이름을 메모장에 기록해 둔다.

### CREO3_STARTUP_DJDMP 프로젝트 받기
* 이 프로젝트에는, CREO CAD의 모든 환경설정이 들어있다.
* 'Link to Folder'를 누르면, 받아올 장소를 선택하도록 한다.  위치는 `E:\GrabCAD`로 찾아들어간 후, 여기서 `CREO3_STARTUP_DJDMP` 폴더를 만들어서 그곳으로 지정한다.
* 그러면 자동으로 다운로드가 진행되면서 설치가 된다.
* 이제 CREO 실행아이콘을 마우스 오른쪽 버튼을 누르고 '속성'을 선택한 다음, '시작 위치'를 `E:\GrabCAD\CREO3_STARTUP_DJDMP`으로 변경해 준다.  그러면 이 아이콘으로 CREO를 실행하게 되면 이 설정이 적용되게 된다.

### LIB 프로젝트 받기
* 이 프로젝트에는, CREO CAD에서 사용할 공용부품들이 들어있다.
* 'Link to Folder'를 누르면, 받아올 장소를 선택하도록 한다.  위치는 `E:\GrabCAD`로 찾아들어간 후, 여기서 `LIB` 폴더를 만들어서 그곳으로 지정한다.
* 그러면 자동으로 다운로드가 진행되면서 설치가 된다.

### 유의사항
* CREO3_STARTUP_DJDMP와 LIB 프로젝트는 공용 환경설정 사항이므로, 기본적으로 팀장이 Lock을 걸어놓아 수정 권한을 막아놓았다.
* Lock이 걸려있기 때문에, 로컬에서 파일을 변경하는 것은 상관없지만 그것이 클라우드로 업로드 싱크 되는 것은 금지된다.
* 변경/개선안이 있을 경우에는 팀장과 의논하여 팀장으로하여금 업데이트하도록 한다.
* 그러면 모든 팀원이 동일한 환경으로 동시에 업데이트 된다.

### 실제 작업할 프로젝트 받기
* 팀장으로부터 공유된 실제 작업할 프로젝트가 'LPL2'일 경우, 위의 LIB 프로젝트와 마찬가지 절차로 다운로드 받을 수 있다.
* 이제 여기서 CAD 작업을 진행하면 된다.
* 설계 진행중에는, 팀장 및 다른 팀원들과 협의하여 동일 파일을 여러 사람이 동시에 수정하여 충돌이 발생하지 않도록 유의한다.
* 서브어셈블리별로 수정 영역을 분담하여, 상호간 레퍼런스가 꼬이지 않도록 주의깊게 통제하는 것이 좋겠다.
* 가장 안전한 방법은, 해당 프로젝트를 한 사람이 수정할 때는 다른 사람은 아에 건드리지 않는 것이다.  1인 1프로젝트 체제로 명확히 역할 분담을 하면 가능하다.


## 컨텍스트 메뉴 유틸리티 설치 및 사용
* 네트워크 드라이브가 작업 드라이브일 경우에는, `E:\GrabCAD\CREO3_STARTUP_DJDMP\BATCH\DymaxionKim_NetUse.bat` 파일을 `C:`드라이브의 원하는 장소에 카피하고, 편집기를 열어서 네트워크 드라이브 주소를 변경해 준다.  그리고 이 파일을 마우스 오른쪽 버튼을 누르고 `관리자 권한으로 실행`을 선택해서 실행해 준다. (관리자 계정에서 해당 네트워크 드라이브를 E:드라이브로 강제 할당해 주는 것임)  이후 재부팅할 때 마다 이걸 반복해 주거나, 또는 부팅시에 자동 실행되도록 셋팅해 두면 된다.
* 그냥 로컬 드라이브가 `E:`로 잡혀있다면 위 작업은 해 줄 필요가 없다.
* `E:\GrabCAD\CREO3_STARTUP_DJDMP\BATCH\DymaxionKim_Settup.bat` 파일을 마우스 오른쪽 버튼을 누르고 `관리자 권한으로 실행`을 선택해서 실행해 준다.  이것은 레지스트리를 새로 만들어 컨텍스트 메뉴(특정 폴더를 마우스 오른쪽 클릭 할 때 뜨는 메뉴)를 추가해 주는 것이다.
* 이제 작업중인 폴더를 탐색기에서 마우스 오른쪽 클릭하면 미리 설정해 둔 몇가지 자동화 기능을 사용할 수 있게 된다.
* `D1_Purge`는 CREO에 내장된 purge.bat 파일을 해당 폴더에서 실행해 준다.
* `D2_PurgeClear`는 purge 동작을 하고, 추가로 불필요한 파일들을 전부 삭제해 주고, 또 각 파일의 버전 넘버링을 1로 통일시켜 정리해 준다.
* `D3_drw2pdfdxfdwg`는 해당 폴더에서, drw 파일을 모두 찾아 매크로 동작을 통해 자동적으로 pdf, dxf, dwg 포멧의 도면 파일을 일괄 생성해 준다.
* GrabCAD 등을 통해 클라우드 서버 쪽과 Sync 시키기 전에 반드시 `D2_PurgeClear`를 수행해서 해당 폴더를 깨끗하게 정리해 주도록 한다.


## ETC
* GrabCAD 장점
  - 별다른 소프트웨어 없이 웹에서 3D 모델을 직접 리뷰할 수 있다.
  - 3D 모델에 직접 코멘팅 및 의사소통이 가능하다.
  - 사용법이 비교적 쉽다.
  - 최소한이나마 Lock 기능이 있어 데이타 충돌을 최소화시킬 수 있다.
  - 공짜 + 무제한 용량
* GrabCAD 단점
  - 한글 코멘트는 표시되지 못한다.
  - BOM 기능이 부족하다.  한글은 깨지고, 패밀리 파트의 인스턴스 네임은 인식하지 못한다.
  - 브랜치 분기가 안된다.
  - 업로드 속도가 상당히 느리다.
  - 퍼블릭 클라우드라서 안정성에 대한 책임을 지울 수 없다.
* 단점 보완을 위해 향후에는 Git 클라이언트 기능도 추가하는 것이 좋겠다.
  - 클라이언트 단으로 TortoiseGIT을 검토해 봤는데, 기구데이타 다루기에는 딱 맞지 않고 또 기구설계자에게는 쓸데없이 복잡해 보일 수 있다.
  - 따라서 Git for Windows만 설치하고, 배치파일을 통해 단순하게 Pull,Commit,Push만 수행되도록 컨텍스트 메뉴 추가 방법을 생각해 보는 것이 좋겠다.
  - 고급 기능은 팀장만 사용한다고 가정하고, 고급 기능 사용시에는 Bash 쉘을 열어서 다루면 될 것이다.
  - 클라이언트 쪽 데이타 용량이 증가하는 것은 프로젝트를 실제 운용해 보면서 가늠해 보면 될 것이다.
  - 또 용량 증가를 억제하기 위해 커밋을 특정 마일스톤에 도달했을 때만 한다던가 하는 식으로 제한하면서 운용하면 어떨까.  즉 소프트웨어 개발자들이 잦은 커밋을 하는 습관을 가지는 것과 정반대로 운용하는 것이다.
  - 팀원들이 너무 부담스러워 한다면, GrabCAD로 프로젝트를 진행하되, 팀장만 Git으로 버전관리해 주면 어떨까도 싶다.
  - 아울러, Git 리모트 서버 쪽은 GOGS 또는 Gitea 중에 택일하는 것이 제일 좋을 것 같다.  DB는 제일 단순하고 부담이 적은 SQLite3로 해도 프로젝트들이 너무 거대해지고 커뮤니티가 복잡하지 않는 이상 별 문제는 없을지도 모른다.
  - 이슈 트래킹이 제일 문제인데...  커밋 메시지와 이슈 넘버를 연계해서 추적성을 확보하기 좋도록 운용하는 기법을 좀 더 연구해야 할 것 같다.
* 컨텍스트 메뉴에 추가하는 유틸리티를 하나 정도 더 늘려보는 것도 좋겠다.  예를 들어 drw 도면이 존재하는 파일들을 일괄작업으로 STEP 파일을 자동 생성해 주는 기능 등.

